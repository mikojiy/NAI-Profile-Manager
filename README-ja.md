# 📝 NovelAI Profile Manager

このTampermonkeyスクリプトは、**NovelAIで画像生成する人向け**に作られました。  
プロンプトをもっと素早く・柔軟に管理したい人、でも**`twintail`や`masterpiece`といった語句を勝手に翻訳されたくない**人のためのツールです。  
あなたの書いたプロンプトは、**そのままの形で扱われます**。

以下に、スクリプトの全機能を、実際にどう動くかに基づいて分かりやすく解説します。

---

### 📥 インストール方法

1. **Tampermonkey をインストール**  
　→ [tampermonkey.net](https://tampermonkey.net) から（Chrome・Firefox・Edge に対応）

2. **下のリンクをクリック**  
　→ [スクリプトをインストール](https://raw.githubusercontent.com/mikojiy/NAI-Profile-Manager/main/NAIPM.user.js)  
　（クリックすると Tampermonkey が自動で開き、「このスクリプトを追加しますか？」と聞いてきます）

3. **「インストール」をクリック**  
　その後、NovelAI の画像生成ページを開いてください：  
　→ https://novelai.net/image

4. **画面の隅に小さな 📝 アイコンが表示されます**  
　これが、あなたのコントロールセンターです！

> 💡 **アイコンが見えない場合**：  
> ブラウザの拡張機能画面（`chrome://extensions` など）で、  
> **開発者モードをオン** → Tampermonkey の **「詳細」** を開き →  
> **「ユーザースクリプトの実行を許可」** にチェックを入れてください。

これで準備完了！あとは自由にプロファイルを活用してください 🎉

---

## 🎯 プロンプトプロファイル

よく使うプロンプトの組み合わせを「プロファイル」として保存できます。

- 各プロファイルには2つの欄があります：  
  ✅ **ポジティブプロンプト**（出したいもの）  
  ❌ **ネガティブプロンプト**（出したくないもの）
- 例：`anime girl`、`cyberpunk city`、`miku concert` など、好きなだけ作れます。
- プロファイルはいつでも名前変更・削除・並び替え可能。

> 💡 **便利技**：`Ctrl+1`～`Ctrl+9` でプロファイル#1～#9を即適用。`Ctrl+0` = #10。クリック不要！

---

## 🌐 グローバル変数（`{名前}`）

よく使うプロンプトの塊を、短い名前で呼び出せます。

**使い方**：  
こんな変数を登録：  miku = ツインテール, 青髪, 水色の目

プロンプト内ではこう書くだけ：  masterpiece, {miku}, looking at viewer


適用時に `{miku}` が自動で展開されます。

- **🔤 グローバル変数**ボタンから一括管理可能。
- 書式：`名前=値`（1行につき1つ）。

> ⚠️ 変数はプロンプトに直接書き込まれるわけではなく、**適用時に一時的に値を入力するダイアログ**が表示されます。元のプロファイルは一切変わりません。

---

## 🎲 ワイルドカード（`[名前]`）

リストから**ランダムに選んで挿入**できる機能。バリエーションを試すのに最適。

**例**：  
ワイルドカード登録：  キャラクター = miku, teto, luka

プロンプトで使う： [キャラクター], solo, portrait


適用時にポップアップが出て、**どれを使うか選べます**（空欄にすればその部分が消えます）。

---

## 🔍 Danbooru連携（`{DB}`）

Danbooruの投稿から**実際のタグを直接取得**してプロンプトに挿入。

1. プロンプトの任意の位置に `{DB}` と書く（例：`masterpiece, {DB}, solo`）。
2. **上書き**または**追加**を押すと、投稿ID（例：`789532`）を入力するダイアログが出る。
3. スクリプトがキャラ・著作・一般タグを取得 → **ブラックリストのタグを自動除外**（例：`text`, `watermark` など）。
4. `{DB}` の位置にきれいなタグが挿入される。

> ✅ `blue_eyes` は自動で `blue eyes` に変換され、重複も削除されます。  
> プロファイルを使わず、**🔍 Danbooru**ボタンだけでタグ取得も可能。

---

## 🛑 タグブラックリスト

Danbooruから不要なタグを弾きたい？  
**⚙️ 設定とブラックリスト**から登録できます。

例：  白背景, 屋外, 上半身, テキスト, ウォーターマーク


これらのタグは、Danbooru取得時に**自動で除外**されます。

---

## ➕ 上書き vs. 追加

- **🔄 上書き**：エディタの内容を完全に置き換え。
- **➕ 追加**：現在のプロンプトの末尾に、プロファイルの内容を追記（カンマで接続）。

どちらも**ポジティブ・ネガティブ両方**に同時に適用されます。

---

## 💾 完全バックアップ & 復元

すべてのデータを**1つのJSONファイル**で保存・復元可能：

- 全プロファイル
- グローバル変数・ワイルドカード
- ブラックリスト
- UI設定（ダークモード、アイコン位置など）
- 最後に使ったプロファイルやDanbooru ID

> 🔒 データはあなたのブラウザ内にしか保存されません。自分でエクスポートしない限り、外部には出ません。

---

## ⌨️ キーボードショートカット

| ショートカット | 機能 |
|--------------|------|
| `Ctrl+1` ～ `Ctrl+0` | プロファイル#1～#10を適用 |
| `Ctrl+Q` | プロファイルを**名前 or 番号**で検索 |

パネルが閉じていても使えます！

---

## 🌗 ダークモード & アイコン移動

- **🌙/☀️** ボタンで明るい・暗いモードを切り替え。
- 📝 アイコンは画面のどこにでもドラッグ可能。位置は次回起動時にも記憶されます。

---

## 🔄 自動アップデート通知

NovelAIを開くたびに、最新版があるかチェック。  
アップデートがあれば、右上に**目立たない通知**が出て、1クリックでインストール可能。

---

## ❓「変数入力ダイアログ」について

プロンプトに以下の要素が含まれている場合：
- `{変数}`
- `[ワイルドカード]`
- `{DB}`

適用前に**一時的な入力ダイアログ**が表示されます。ここで：
- 変数の値を入力
- ワイルドカードから選択
- Danbooru IDを指定

できます。  
**元のプロファイルは一切変更されません** — あくまでその1回だけの適用用です。

---

## 💖 開発者をサポート

このスクリプトは**完全無料・広告なし・オープンソース**です。  
でも、もし作業が楽になった・気に入ってもらえたら、コーヒー1杯おごってくれると嬉しいです！ ☕

→ [https://ko-fi.com/mikojiy](https://ko-fi.com/mikojiy)

あなたの支援が、このツールの継続と改善につながります。

---

NovelAIでプロンプトを**素早く、自由に、楽しく**扱いたいすべての人のために、心を込めて作りました。  
あなたの創造が、少しでもスムーズになりますように。✨
